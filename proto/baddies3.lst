0R=%1+%3:S=%1+R:U=%2+S:V=%2+U:T=%2+V:GR.%0:A=40:B=48192:C=T*A+B-%1:D=%2:E=%2:F=D+E+E:DIMA(F):F.G=%0TOD:A(G)=B+A+RAND(S*A):POKEA(G),S:N.G:F.G=%1TOE:H=RAND(A):A(D+G)=10*A+B+H:POKEA(D+G),R:A(D+E+G)=RAND(6)*A+B+H:POKEA(D+E+G),V:N.G:DO›1I=NOTI:REP.:J=B+K:L=PEEK(J):M=J+A:N=PEEK(M):O=J-A:IFL=R:IFPEEK(O)=N:POKEJ,%0:POKEM,R:END.:END.:IF(I=%0)+S=L:P=RAND(%3)+M-%1:IF(P<C)&(PEEK(P)=%0):POKEJ,%0:POKEP,S+I:EL.:POKEJ,U+I:END.:END.:IF(I=%0)+U=L:P=RAND(%3)+O-%1:IF(P>B)&(PEEK(P)=%0):POKEJ,%0›2POKEP,U+I:EL.:POKEJ,S+I:END.:END.:IF(I=%0)+V=L:IFN=%0:POKEJ,%0:POKEM,V+I:EL.:IFN<R:POKEJ,U+I:END.:END.:IFN=R:POKEJ,T+I:END.:END.:IF(I=%0)+T=L:IFO>B:POKEM,%0:POKEO,T+I:POKEJ,R:EL.:POKEM,%0:POKEJ,%0:Q=Q-%1:END.:END.:K=K+%1:U.A*T=K:K=%0:LOOP›