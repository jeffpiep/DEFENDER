0Q=%1+%3:R=%1+Q:S=%1+R:U=%1+S:T=%1+U:GR.%0:F.A=%0TO39:POS.A,11:?"!";:N.A:B=40:C=48192:D=11*B+C-%1:E=10:F=R:G=E+F+F:DIMA(G):F.A=%0TOE:A(A)=C+B+RAND(R*B):POKEA(A),R:N.A:F.A=%1TOF:H=RAND(B):A(E+A)=S*B+C+H:POKEA(E+A),Q›1A(E+F+A)=RAND(T)*B+C+H:POKEA(E+F+A),U:N.A:DO:I=%0:REP.:J=A(I):IFJ>%0:K=PEEK(J):L=J+B:M=PEEK(L):N=J-B:IFK=Q:IFPEEK(N)=%0=%0:POKEJ,%0:POKEL,Q:A(I)=L:END.:END.:IFK=R:O=RAND(%3)+L-%1:IF(O<D)&(PEEK(O)=%0):POKEJ,%0:POKEO,R:A(I)=O:EL.:POKEJ,S:END.:END.:IFK=S›2O=RAND(%3)+N-%1:IF(O>C)&(PEEK(O)=%0):POKEJ,%0:POKEO,S:A(I)=O:EL.:POKEJ,R:END.:END.:IFK=U:IFM=%0:POKEJ,%0:POKEL,U:A(I)=L:EL.:IFM<Q:POKEJ,S:END.:END.:IFM=Q:POKEJ,T:END.:END.:IFK=T:IFN>C:POKEL,%0:POKEN,T:POKEJ,Q:A(I)=N:EL.:POKEL,%0:POKEJ,%0:A(I)=-1:P=P-%1›3END.:END.:END.:I=I+%1:U.I>G:LOOP›